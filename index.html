<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
<title>MC SERVERS | THE BOSS ENGINE</title>

<!-- ✅ FIXED VERCEL ANALYTICS -->
<script defer src="https://vercel.com/analytics/script.js"></script>

<link href="https://fonts.googleapis.com/css2?family=Press+Start+2P&family=Montserrat:wght@700;900&display=swap" rel="stylesheet">

<style>
:root {
  --mc-green:#5ea82d;--mc-dirt:#4b3621;--mc-stone:#313131;
  --neon:#00ff41;--bg:#0a0a0a;
}
*{box-sizing:border-box;transition:.2s}
body{margin:0;background:var(--bg);color:#fff;font-family:Montserrat,sans-serif;overflow-x:hidden}

/* MUSIC */
.music-panel{position:fixed;top:20px;right:20px;z-index:2000;background:#000;padding:10px;border-radius:30px;border:2px solid var(--mc-green)}
.m-btn{background:var(--mc-green);border:none;font-weight:900;padding:6px 15px;border-radius:20px;cursor:pointer;font-size:10px}

/* HERO */
.hero{
  height:250px;
  background:linear-gradient(rgba(0,0,0,.5),var(--bg)),url('tema.jpg') center/cover;
  display:flex;flex-direction:column;align-items:center;justify-content:center;
  border-bottom:8px solid var(--mc-dirt)
}
.hero h1{font-family:'Press Start 2P';font-size:clamp(1.2rem,5vw,2.5rem);margin:0}
.stats-sub{font-size:16px;font-weight:900;letter-spacing:10px;color:rgba(255,255,255,.2)}

#search{
  width:70%;max-width:450px;margin-top:15px;
  background:#000;border:3px solid var(--mc-green);
  color:var(--neon);padding:10px;font-family:'Press Start 2P';font-size:10px
}

/* NAV */
.nav-scroll{display:flex;gap:8px;overflow-x:auto;background:#111;padding:15px;position:sticky;top:0;z-index:1000}
.nav-btn{background:#333;border:3px solid #000;border-bottom:6px solid #000;color:#fff;padding:10px 18px;font-size:11px;font-weight:900;cursor:pointer}
.nav-btn.active{background:var(--mc-green);transform:translateY(3px)}

/* GRID */
.container{max-width:1300px;margin:20px auto;padding:0 20px}
.card{
  background:var(--mc-stone);border:4px solid #000;
  display:grid;grid-template-columns:50px 70px 1fr 120px 160px;
  padding:15px;margin-bottom:15px;position:relative;overflow:hidden
}

/* ✅ BANNER FIX */
.card-bg{
  position:absolute;inset:0;
  width:100%;height:100%;
  object-fit:contain;
  opacity:.25;z-index:0;pointer-events:none
}

.card>*{z-index:1}
.server-icon{width:64px;height:64px;border:3px solid #000;background:#000}
.col-rank{font-family:'Press Start 2P';font-size:18px;color:rgba(255,255,255,.1)}
.col-info h4{margin:0;font-size:22px;display:flex;gap:8px}
.col-players{font-family:'Press Start 2P';font-size:14px;color:var(--mc-green);text-align:center}
.btn-copy{background:var(--mc-green);border:3px solid #000;border-bottom:6px solid #2d5116;padding:12px;font-weight:900;cursor:pointer}

.pagination{display:flex;justify-content:center;gap:10px;margin:30px 0}
.pag-btn{background:#222;border:2px solid #000;color:#fff;padding:10px 15px;cursor:pointer}
.pag-btn.active{background:var(--mc-green);color:#000}

/* ADMIN */
.modal{display:none;position:fixed;inset:0;background:#000;z-index:9999;align-items:center;justify-content:center}
.modal.active{display:flex}
.admin-box{background:var(--mc-stone);border:6px solid #000;padding:25px;max-width:550px;width:100%}
.admin-input{width:100%;padding:12px;background:#000;border:3px solid var(--mc-dirt);color:#fff;margin-bottom:10px}
.save-btn{width:100%;background:var(--mc-green);border:3px solid #000;border-bottom:6px solid #2d5116;padding:15px;font-weight:900;cursor:pointer}

@media(max-width:900px){
  .card{grid-template-columns:1fr 1fr}
}
</style>
</head>

<body>

<audio id="bgm" loop></audio>
<div class="music-panel">
  <button class="m-btn" id="mBtn" onclick="toggleMusic()">PLAY AUDIO</button>
</div>

<header class="hero" id="mainHero">
  <h1>MC SERVERS</h1>
  <div class="stats-sub">STATS</div>
  <input id="search" placeholder="FIND A REALM..." onkeyup="resetAndRender()">
</header>

<nav class="nav-scroll" id="catNav"></nav>
<div class="container" id="grid"></div>
<div class="pagination" id="pagin"></div>

<div id="adminModal" class="modal">
<div class="admin-box">

<div id="loginArea">
<input type="password" id="adminPass" class="admin-input" placeholder="Password">
<button class="save-btn" onclick="login()">LOGIN</button>
</div>

<div id="actionArea" style="display:none">
<button class="save-btn" onclick="showEditor('new')">ADD SERVER</button>
<label class="save-btn" style="background:#222">
UPLOAD MUSIC
<input type="file" id="musicUpload" hidden accept="audio/mpeg">
</label>
</div>

<div id="editorArea" style="display:none">
<input id="edIp" class="admin-input" placeholder="IP">
<input id="edName" class="admin-input" placeholder="Name">
<select id="edCat" class="admin-input"></select>

<!-- ✅ MP4 SUPPORT -->
<input type="file" id="edBannerFile" class="admin-input" accept="image/*,video/mp4">

<button class="save-btn" onclick="saveServer()">SAVE</button>
</div>

</div>
</div>

<script>
const categories=["All","Survival","Skyblock","Factions","Anarchy","Bedwars","Creative","Prison","RPG","BoxPvP"];
let servers=JSON.parse(localStorage.getItem("mc_boss_v1"))||[];
let curCat="All",curPage=1,perPage=5,editId=null,tempBanner="";

const catNav=document.getElementById("catNav");
const edCat=document.getElementById("edCat");

categories.forEach(c=>{
  catNav.innerHTML+=`<button class="nav-btn ${c==="All"?"active":""}" onclick="setCat('${c}',this)">${c}</button>`;
  if(c!=="All") edCat.innerHTML+=`<option>${c}</option>`;
});

document.getElementById("edBannerFile").onchange=e=>{
  const r=new FileReader();
  r.onload=()=>tempBanner=r.result;
  r.readAsDataURL(e.target.files[0]);
};

document.getElementById("musicUpload").onchange=e=>{
  const r=new FileReader();
  r.onload=()=>{
    localStorage.setItem("mc_music",r.result);
    document.getElementById("bgm").src=r.result;
  a.play();
  };
  r.readAsDataURL(e.target.files[0]);
};

if(localStorage.getItem("mc_music"))
  document.getElementById("bgm").src=localStorage.getItem("mc_music");

function render(){
  const grid=document.getElementById("grid");
  const term=document.getElementById("search").value.toLowerCase();
  const filtered=servers.filter(s=>
    (curCat==="All"||s.cat===curCat)&&
    (s.name.toLowerCase().includes(term)||s.ip.includes(term))
  );
  const start=(curPage-1)*perPage;
  grid.innerHTML=filtered.slice(start,start+perPage).map((s,i)=>`
  <div class="card">
    ${
      s.banner
      ? (s.banner.startsWith("data:video")
        ? `<video class="card-bg" src="${s.banner}" autoplay muted loop></video>`
        : `<img class="card-bg" src="${s.banner}">`)
      : ""
    }
    <div class="col-rank">#${start+i+1}</div>
    <img class="server-icon" src="https://api.mcsrvstat.us/icon/${s.ip}">
    <div class="col-info"><h4>${s.name}</h4>${s.ip}</div>
    <div class="col-players">${s.online||0}</div>
    <button class="btn-copy" onclick="copyIp('${s.ip}',this)">COPY IP</button>
  </div>
  `).join("");
}

function saveServer(){
  servers.push({
    id:Date.now(),
    ip:edIp.value,
    name:edName.value,
    cat:edCat.value,
    banner:tempBanner,
    online:0
  });
  localStorage.setItem("mc_boss_v1",JSON.stringify(servers));
  location.reload();
}

function copyIp(ip,btn){
  navigator.clipboard.writeText(ip);
  btn.innerText="COPIED";
}

function toggleMusic(){
  const a=document.getElementById("bgm");
  a.paused?a.play():a.pause();
}

function setCat(c,b){
  document.querySelectorAll(".nav-btn").forEach(x=>x.classList.remove("active"));
  b.classList.add("active");
  curCat=c;render();
}

function resetAndRender(){curPage=1;render()}
function login(){
  if(adminPass.value==="elif"){
    loginArea.style.display="none";
    actionArea.style.display="block";
  }
}

render();
</script>

</body>
</html>
